{% extends "base.html" %}

{% block head %}
    <script>
        async function new_ticket() {
            const wrongSpan = document.getElementById("wrong_span");
            wrongSpan.textContent = "";

            const url = "http://localhost:8000/tickets";
            const event_id = parseInt(document.getElementById("event_id").innerHTML)

            await fetch(`${url}?event_id=${event_id}`, {method: 'POST'}).then(response => {
                if (response.status === 200) {
                    window.location.href = "/pages/tickets"
                } else {
                    wrongSpan.textContent = "Что-то пошло не так";
                }
            });
        }
    </script>
{% endblock %}

{% block content %}
<p style="display: none" id="event_id">{{ event.id }}</p>
<div class="flex flex-col items-center">
    <div class="flex justify-center mb-10 text-3xl">
        Бронь билета на&nbsp;<span class="font-bold">{{ event.title }}</span>
    </div>

    <div class="mb-5">
        <div class="mb-2 pl-1">Тип мероприятия: {{ event.event_type }}</div>
        <div class="mb-2 pl-1">Место проведения: {{ event.location }}</div>
        <div class="mb-2 pl-1">Цена: {{ event.price }}</div>
        <div class="mb-2 pl-1">Дата проведения: {{ event.date }}</div>
    </div>

    <div>
        <button class="text-lg bg-yellow-400 px-3 py-1 rounded-3xl mb-3" onclick="new_ticket()">Забронировать билет</button>
        <span id="wrong_span" ></span>
    </div>
</div>
{% endblock %}